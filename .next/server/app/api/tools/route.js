"use strict";(()=>{var e={};e.id=443,e.ids=[443],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9617:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>w,patchFetch:()=>g,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var a={};s.r(a),s.d(a,{GET:()=>u,fetchCategorizedTools:()=>c});var i=s(49303),r=s(88716),o=s(60670),n=s(87070),l=s(45019);async function u(e){try{let{searchParams:t}=new URL(e.url),s=t.get("category"),a=t.get("search"),i=t.get("serverId"),r=parseInt(t.get("limit")??"50",10),o=parseInt(t.get("offset")??"0",10),u=await l.U.getTools({category:s??void 0,searchQuery:a??void 0,serverId:i??void 0,isEnabled:!0,limit:r,offset:o});return n.NextResponse.json({tools:u.tools,totalCount:u.totalCount,hasMore:u.hasMore})}catch(e){return console.error("[Tools API] Error listing tools:",e),n.NextResponse.json({error:"Failed to list tools"},{status:500})}}async function c(){try{let e=await l.U.getCategorizedTools();return n.NextResponse.json({categories:e})}catch(e){return console.error("[Tools API] Error getting categories:",e),n.NextResponse.json({error:"Failed to get tool categories"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/tools/route",pathname:"/api/tools",filename:"route",bundlePath:"app/api/tools/route"},resolvedPagePath:"C:\\Users\\asher\\PROJECTS\\OMNI-PRIME\\src\\app\\api\\tools\\route.ts",nextConfigOutput:"export",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:m}=d,w="/api/tools/route";function g(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},45019:(e,t,s)=>{s.d(t,{U:()=>u});var a=s(5499),i=s(48645),r=s(57745),o=s(22070);let n={read_file:"filesystem",write_file:"filesystem",list_directory:"filesystem",search_files:"filesystem",filesystem:"filesystem",fetch:"web",web_search:"web",brave_search:"web",http_request:"web",query:"database",execute_sql:"database",sqlite:"database",database:"database",api_call:"api",rest_api:"api",graphql:"api",send_message:"communication",email:"communication",slack:"communication",run_command:"development",execute_code:"development",github:"development",git:"development",npm:"development",parse_csv:"data",parse_json:"data",analyze_data:"data",chart:"data"};class l{async getTools(e={}){let t=(0,a.V)(),{searchQuery:s,category:n,serverId:l,isEnabled:u,limit:c=50,offset:d=0}=e,p=[];l&&p.push((0,r.eq)(i.a$.serverId,l)),void 0!==u&&p.push((0,r.eq)(i.a$.isEnabled,u)),s&&p.push((0,o.i6)`(${i.a$.name} LIKE ${`%${s}%`} OR ${i.a$.description} LIKE ${`%${s}%`})`);let h=t.query.mcpTools.findMany({where:p.length>0?(0,r.xD)(...p):void 0,with:{server:!0},limit:c,offset:d,orderBy:[(0,o.i6)`${i.a$.useCount} DESC`]}),m=await h,w=m;n&&(w=m.filter(e=>this.categorizeTool(e)===n));let g=await t.select({count:(0,o.i6)`count(*)`}).from(i.a$).where(p.length>0?(0,r.xD)(...p):void 0),y=Number(g[0]?.count??0);return{tools:w,totalCount:y,hasMore:d+w.length<y}}async getTool(e){let t=this.cache.get(e);if(t&&Date.now()-this.cacheTimestamp<this.CACHE_TTL)return t;let s=(0,a.V)(),o=await s.query.mcpTools.findFirst({where:(0,r.eq)(i.a$.id,e),with:{server:!0}});return o&&(this.cache.set(e,o),this.cacheTimestamp=Date.now()),o??null}async getToolsByIds(e){if(0===e.length)return[];let t=(0,a.V)();return await t.query.mcpTools.findMany({where:(0,o.i6)`${i.a$.id} IN ${e}`,with:{server:!0}})}async getAgentTools(e){let t=(0,a.V)();return(await t.query.agentTools.findMany({where:(0,r.xD)((0,r.eq)((0,o.i6)`agent_id`,e),(0,r.eq)((0,o.i6)`is_enabled`,!0)),with:{tool:{with:{server:!0}}}})).map(e=>e.tool).filter(e=>null!==e)}convertToGatewayTools(e){return e.map(e=>({type:"function",function:{name:e.name,description:e.description??`Execute ${e.name}`,parameters:e.inputSchema}}))}categorizeTool(e){let t=e.name.toLowerCase(),s=(e.description??"").toLowerCase();if(n[t])return n[t];for(let[e,a]of Object.entries(n))if(t.includes(e)||s.includes(e))return a;let a=e.server?.name.toLowerCase()??"";return a.includes("filesystem")?"filesystem":a.includes("web")||a.includes("search")?"web":a.includes("sqlite")||a.includes("database")?"database":a.includes("github")?"development":"custom"}async getCategorizedTools(){let{tools:e}=await this.getTools({isEnabled:!0,limit:1e3}),t={filesystem:[],web:[],database:[],api:[],communication:[],development:[],data:[],custom:[]};for(let s of e){let e=this.categorizeTool(s);t[e].push({tool:s,category:e,tags:this.extractTags(s),popularity:s.useCount})}for(let e of Object.keys(t))t[e].sort((e,t)=>t.popularity-e.popularity);return t}async setToolEnabled(e,t){let s=(0,a.V)();await s.update(i.a$).set({isEnabled:t}).where((0,r.eq)(i.a$.id,e)),this.cache.delete(e)}async recordToolUsage(e){let t=(0,a.V)();await t.update(i.a$).set({useCount:(0,o.i6)`${i.a$.useCount} + 1`,lastUsedAt:new Date}).where((0,r.eq)(i.a$.id,e));let s=this.cache.get(e);s&&(s.useCount++,s.lastUsedAt=new Date)}async getToolCapabilities(){let{tools:e}=await this.getTools({isEnabled:!0,limit:1e3});return e.map(e=>({toolId:e.id,toolName:e.name,capabilities:this.extractCapabilities(e),inputTypes:this.extractInputTypes(e),outputTypes:this.extractOutputTypes(e)}))}async findToolsByCapability(e,t=5){let s=(await this.getToolCapabilities()).filter(t=>t.capabilities.some(t=>t.toLowerCase().includes(e.toLowerCase()))).sort((t,s)=>{let a=t.capabilities.some(t=>t.toLowerCase()===e.toLowerCase()),i=s.capabilities.some(t=>t.toLowerCase()===e.toLowerCase());return a&&!i?-1:!a&&i?1:0}).slice(0,t).map(e=>e.toolId);return this.getToolsByIds(s)}clearCache(){this.cache.clear(),this.cacheTimestamp=0}extractTags(e){let t=[],s=`${e.name} ${e.description??""}`.toLowerCase();return s.includes("read")&&t.push("read"),s.includes("write")&&t.push("write"),s.includes("search")&&t.push("search"),s.includes("create")&&t.push("create"),s.includes("delete")&&t.push("delete"),s.includes("update")&&t.push("update"),s.includes("list")&&t.push("list"),s.includes("get")&&t.push("get"),s.includes("execute")&&t.push("execute"),s.includes("run")&&t.push("run"),t}extractCapabilities(e){let t=[],s=e.name.toLowerCase(),a=(e.description??"").toLowerCase();return s.includes("file")&&t.push("file-operations"),s.includes("search")&&t.push("search"),s.includes("query")&&t.push("query"),s.includes("fetch")&&t.push("fetch"),s.includes("send")&&t.push("send"),s.includes("create")&&t.push("create"),s.includes("update")&&t.push("update"),s.includes("delete")&&t.push("delete"),a.includes("read")&&t.push("read"),a.includes("write")&&t.push("write"),[...new Set(t)]}extractInputTypes(e){let t=e.inputSchema,s=[];if(t.properties)for(let[e,a]of Object.entries(t.properties))a.type&&s.push(`${e}:${a.type}`);return s}extractOutputTypes(e){return["text","data"]}constructor(){this.cache=new Map,this.cacheTimestamp=0,this.CACHE_TTL=6e4}}let u=new l},57745:(e,t,s)=>{s.d(t,{eq:()=>n,xD:()=>l});var a=s(83596),i=s(19326),r=s(80298),o=s(22070);let n=(e,t)=>(0,o.i6)`${e} = ${(function(e,t){return!(0,o._B)(t)||(0,o.zl)(e)||(0,i.is)(e,o.dO)||(0,i.is)(e,o.Vm)||(0,i.is)(e,a.s)||(0,i.is)(e,r.iA)||(0,i.is)(e,o.G7)?e:new o.dO(e,t)})(t,e)}`;function l(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new o.$s(1===t.length?t:[new o.Zm("("),o.i6.join(t,new o.Zm(" and ")),new o.Zm(")")])}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,656,70,148],()=>s(9617));module.exports=a})();