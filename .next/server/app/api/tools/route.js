"use strict";(()=>{var e={};e.id=443,e.ids=[443],e.modules={85890:e=>{e.exports=require("better-sqlite3")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9617:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var a={};s.r(a),s.d(a,{GET:()=>c,fetchCategorizedTools:()=>u});var r=s(49303),o=s(88716),i=s(60670),l=s(87070),n=s(45019);async function c(e){try{let{searchParams:t}=new URL(e.url),s=t.get("category"),a=t.get("search"),r=t.get("serverId"),o=parseInt(t.get("limit")??"50",10),i=parseInt(t.get("offset")??"0",10),c=await n.U.getTools({category:s??void 0,searchQuery:a??void 0,serverId:r??void 0,isEnabled:!0,limit:o,offset:i});return l.NextResponse.json({tools:c.tools,totalCount:c.totalCount,hasMore:c.hasMore})}catch(e){return console.error("[Tools API] Error listing tools:",e),l.NextResponse.json({error:"Failed to list tools"},{status:500})}}async function u(){try{let e=await n.U.getCategorizedTools();return l.NextResponse.json({categories:e})}catch(e){return console.error("[Tools API] Error getting categories:",e),l.NextResponse.json({error:"Failed to get tool categories"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/tools/route",pathname:"/api/tools",filename:"route",bundlePath:"app/api/tools/route"},resolvedPagePath:"C:\\Users\\asher\\PROJECTS\\OMNI-PRIME\\src\\app\\api\\tools\\route.ts",nextConfigOutput:"export",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=p,g="/api/tools/route";function w(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},45019:(e,t,s)=>{s.d(t,{U:()=>u});var a=s(5499),r=s(48645),o=s(57745),i=s(31626);let l={read_file:"filesystem",write_file:"filesystem",list_directory:"filesystem",search_files:"filesystem",filesystem:"filesystem",fetch:"web",web_search:"web",brave_search:"web",http_request:"web",query:"database",execute_sql:"database",sqlite:"database",database:"database",api_call:"api",rest_api:"api",graphql:"api",send_message:"communication",email:"communication",slack:"communication",run_command:"development",execute_code:"development",github:"development",git:"development",npm:"development",parse_csv:"data",parse_json:"data",analyze_data:"data",chart:"data"},n=e=>{if(!e)return null;let t=e.server?{...e.server,args:e.server.args??[],description:e.server.description??"",url:e.server.url??"",config:e.server.config??{},isSecure:!!e.server.isSecure,acceptsFile:!!e.server.acceptsFile}:void 0;return{...e,description:e.description??"",inputSchema:e.inputSchema??{},lastUsedAt:e.lastUsedAt??null,server:t}};class c{async getTools(e={}){let t=(0,a.V)(),{searchQuery:s,category:l,serverId:c,isEnabled:u,limit:p=50,offset:d=0}=e,h=[];c&&h.push((0,o.eq)(r.mcpTools.serverId,c)),void 0!==u&&h.push((0,o.eq)(r.mcpTools.isEnabled,u)),s&&h.push((0,i.i6)`(${r.mcpTools.name} LIKE ${`%${s}%`} OR ${r.mcpTools.description} LIKE ${`%${s}%`})`);let m=t.query.mcpTools.findMany({where:h.length>0?(0,o.xD)(...h):void 0,with:{server:!0},limit:p,offset:d,orderBy:[(0,i.i6)`${r.mcpTools.useCount} DESC`]}),g=(await m).map(n).filter(e=>null!==e),w=g;l&&(w=g.filter(e=>this.categorizeTool(e)===l));let T=await t.select({count:(0,i.i6)`count(*)`}).from(r.mcpTools).where(h.length>0?(0,o.xD)(...h):void 0),y=Number(T[0]?.count??0);return{tools:w,totalCount:y,hasMore:d+w.length<y}}async getTool(e){let t=this.cache.get(e);if(t&&Date.now()-this.cacheTimestamp<this.CACHE_TTL)return t;let s=(0,a.V)(),i=n(await s.query.mcpTools.findFirst({where:(0,o.eq)(r.mcpTools.id,e),with:{server:!0}}));return i&&(this.cache.set(e,i),this.cacheTimestamp=Date.now()),i}async getToolsByIds(e){if(0===e.length)return[];let t=(0,a.V)();return(await t.query.mcpTools.findMany({where:(0,i.i6)`${r.mcpTools.id} IN ${e}`,with:{server:!0}})).map(n).filter(e=>null!==e)}async getAgentTools(e){let t=(0,a.V)();return(await t.query.agentTools.findMany({where:(0,o.xD)((0,o.eq)((0,i.i6)`agent_id`,e),(0,o.eq)((0,i.i6)`is_enabled`,!0)),with:{tool:{with:{server:!0}}}})).map(e=>n(e.tool)).filter(e=>null!==e)}convertToGatewayTools(e){return e.map(e=>({type:"function",function:{name:e.name,description:e.description??`Execute ${e.name}`,parameters:e.inputSchema}}))}categorizeTool(e){let t=e.name.toLowerCase(),s=(e.description??"").toLowerCase();if(l[t])return l[t];for(let[e,a]of Object.entries(l))if(t.includes(e)||s.includes(e))return a;let a=e.server?.name.toLowerCase()??"";return a.includes("filesystem")?"filesystem":a.includes("web")||a.includes("search")?"web":a.includes("sqlite")||a.includes("database")?"database":a.includes("github")?"development":"custom"}async getCategorizedTools(){let{tools:e}=await this.getTools({isEnabled:!0,limit:1e3}),t={filesystem:[],web:[],database:[],api:[],communication:[],development:[],data:[],custom:[]};for(let s of e){let e=this.categorizeTool(s);t[e].push({tool:s,category:e,tags:this.extractTags(s),popularity:s.useCount})}for(let e of Object.keys(t))t[e].sort((e,t)=>t.popularity-e.popularity);return t}async setToolEnabled(e,t){let s=(0,a.V)();await s.update(r.mcpTools).set({isEnabled:t}).where((0,o.eq)(r.mcpTools.id,e)),this.cache.delete(e)}async recordToolUsage(e){let t=(0,a.V)();await t.update(r.mcpTools).set({useCount:(0,i.i6)`${r.mcpTools.useCount} + 1`,lastUsedAt:new Date}).where((0,o.eq)(r.mcpTools.id,e));let s=this.cache.get(e);s&&(s.useCount++,s.lastUsedAt=new Date)}async getToolCapabilities(){let{tools:e}=await this.getTools({isEnabled:!0,limit:1e3});return e.map(e=>({toolId:e.id,toolName:e.name,capabilities:this.extractCapabilities(e),inputTypes:this.extractInputTypes(e),outputTypes:this.extractOutputTypes(e)}))}async findToolsByCapability(e,t=5){let s=(await this.getToolCapabilities()).filter(t=>t.capabilities.some(t=>t.toLowerCase().includes(e.toLowerCase()))).sort((t,s)=>{let a=t.capabilities.some(t=>t.toLowerCase()===e.toLowerCase()),r=s.capabilities.some(t=>t.toLowerCase()===e.toLowerCase());return a&&!r?-1:!a&&r?1:0}).slice(0,t).map(e=>e.toolId);return this.getToolsByIds(s)}clearCache(){this.cache.clear(),this.cacheTimestamp=0}extractTags(e){let t=[],s=`${e.name} ${e.description??""}`.toLowerCase();return s.includes("read")&&t.push("read"),s.includes("write")&&t.push("write"),s.includes("search")&&t.push("search"),s.includes("create")&&t.push("create"),s.includes("delete")&&t.push("delete"),s.includes("update")&&t.push("update"),s.includes("list")&&t.push("list"),s.includes("get")&&t.push("get"),s.includes("execute")&&t.push("execute"),s.includes("run")&&t.push("run"),t}extractCapabilities(e){let t=[],s=e.name.toLowerCase(),a=(e.description??"").toLowerCase();return s.includes("file")&&t.push("file-operations"),s.includes("search")&&t.push("search"),s.includes("query")&&t.push("query"),s.includes("fetch")&&t.push("fetch"),s.includes("send")&&t.push("send"),s.includes("create")&&t.push("create"),s.includes("update")&&t.push("update"),s.includes("delete")&&t.push("delete"),a.includes("read")&&t.push("read"),a.includes("write")&&t.push("write"),[...new Set(t)]}extractInputTypes(e){let t=e.inputSchema,s=[];if(t.properties)for(let[e,a]of Object.entries(t.properties))a.type&&s.push(`${e}:${a.type}`);return s}extractOutputTypes(e){return["text","data"]}constructor(){this.cache=new Map,this.cacheTimestamp=0,this.CACHE_TTL=6e4}}let u=new c}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,349,70,499],()=>s(9617));module.exports=a})();